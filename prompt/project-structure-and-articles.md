# 项目结构设计原则和文章定义

## 核心需求

根据文件类型和用途，将项目文件分类组织：

- **部署相关的** → 放入 `deploy/` 目录
- **文章内容相关的** → 放入 `book/` 或其他内容目录
- **垃圾文件** → 放入 `trash/` 目录，并在 `.gitignore` 中忽略，不被别人看到
- **设计文档和 prompt** → 放入 `prompt/` 目录

## 需要显示在博客上的文章的定义

**文章必须同时满足以下条件：**

1. **不在 `deploy/` 目录中** - 部署配置和脚本不应该是文章
2. **不在 `trash/` 目录中** - 垃圾文件不应该显示
3. **不在 `prompt/` 目录中** - 设计文档和 prompt 不是文章内容
4. **不在 `.gitignore` 中被忽略** - 被忽略的文件不应该部署

**满足以上条件的 `.md` 文件会被自动收集、生成并部署到博客上。**

## 设计原则

### 1. 部署相关文件 → `deploy/`

所有与 Hexo 配置、构建、部署相关的文件都应该放在 `deploy/` 目录下：

- Hexo 配置文件（`_config.yml`）
- 部署脚本（`scripts-tools/`）
- GitHub Actions 工作流（`.github/workflows/`）
- 主题和模板文件
- 构建生成的临时文件

**原因**：保持部署配置和文章内容的清晰分离，便于管理和维护。

### 2. 文章内容 → `book/` 等目录

所有文章内容按分类组织在根目录下的各个文件夹中：

- `book/` - 书籍相关文章
- 其他分类目录 - 根据内容主题自由创建（如 `前端/`、`后端/`、`学习/` 等）
- 支持多层嵌套目录结构

**原因**：文章是核心内容，应该清晰可见，便于管理和访问。

### 3. 垃圾文件 → `trash/` + `.gitignore`

不需要的文件放入 `trash/` 目录，并在 `.gitignore` 中忽略：

```gitignore
trash/
```

**原因**：保留文件但不提交到 Git，避免被别人看到，同时本地可以保留作为备份。

### 4. 设计文档 → `prompt/`

项目设计文档、需求记录、prompt 等放入 `prompt/` 目录：

- 项目结构设计原则
- 关键决策记录
- 供 AI 理解项目的 prompt

**原因**：设计文档不是文章内容，不应该显示在博客上，但需要版本控制。

## 项目结构示例

```
/root/code/
├── deploy/              # 部署相关（Hexo 配置、脚本、工作流）
│   ├── scripts-tools/   # 部署脚本
│   ├── _config.yml      # Hexo 配置
│   ├── .github/         # GitHub Actions
│   └── ...
├── book/                # 文章内容（书籍相关）
│   └── heart/
│       └── the-road-to-financial-freedom.md  ✅ 会被部署
├── prompt/              # 设计文档和 prompt
│   └── project-structure-and-articles.md     ❌ 不会被部署
├── trash/               # 垃圾文件（在 .gitignore 中）
│   └── old-article.md   ❌ 不会被部署
└── .gitignore          # 忽略 trash/ 目录
```

## 自动收集机制

GitHub Actions 工作流会自动：

1. 扫描项目根目录下的所有 `.md` 文件
2. 排除以下目录：
   - `deploy/` - 部署相关
   - `trash/` - 垃圾文件
   - `prompt/` - 设计文档
   - `.git/` - Git 元数据
   - `node_modules/` - 依赖包
3. 为符合条件的文件创建符号链接到 `deploy/source/_posts/`
4. 根据文件路径自动设置 permalink
5. 生成静态文件并部署到 GitHub Pages

## 使用场景

这个 prompt 可以用于：

1. **新成员理解项目结构**：快速了解文件组织原则和文章定义
2. **AI 助手理解项目**：喂给大模型时，能快速理解设计意图和文章筛选规则
3. **维护项目一致性**：确保新文件放在正确的位置，符合文章定义的文件会被自动部署

## 文章时间戳规则

每篇文章的 front matter 必须包含时间戳字段：

- **`date`**：文章创建时间，只在首次创建时设置，之后不再修改
- **`updated`**：文章最后修改时间，**每次修改文章内容时必须更新**

示例：
```yaml
---
title: 文章标题
date: 2026-01-19 17:49:09
updated: 2026-01-20 15:30:00  # 每次修改都要更新这个时间
tags:
  - 标签1
  - 标签2
---
```

**排序规则**：
- 博客首页和归档页面按 `updated` 时间倒序排列
- 最近修改的文章会显示在最前面
- 页面上同时显示创建时间和修改时间

## 关键决策记录

- **scripts-tools 的位置**：从根目录移动到 `deploy/scripts-tools/`，因为它们是部署相关的工具
- **trash 目录的处理**：在 `.gitignore` 中忽略，保留本地但不提交，不部署
- **prompt 目录的处理**：设计文档不应该是文章，需要排除
- **文章目录的灵活性**：支持多层嵌套，所有符合定义的文章都会被自动收集和展示
- **文章 URL 规则**：基于文件路径，如 `book/heart/the-road-to-financial-freedom/`
- **时间戳管理**：每次修改文章都要更新 `updated` 字段，按修改时间排序显示

## 日期

2026-01-19

